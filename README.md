# 工具介绍
## 数据获取
 - 配置文件中放入最后一级的m3u8 url，即单码率流(#EXTINF)，如果时多码率流(#EXT-X-STREAM-INF)，需手工拆分做多条单码率url拉流。工具运行保存每次get的m3u8、分片文件。计算get过程中的首字节时延(ttfb)、完整下载时延(ttlb)数据，分别保存到.csv文件中。
## 数据分析
 - 把时延数据放到同一张表格，可通过excel公式对比大小。
 - m3u8有特殊性，不能保证每次获取的sequence一至，所以表格每行没有做对应。
 - 运行工具的日志文件保存在工具所在路径，10个2MBytes文件轮转，暂不能定义输出的日志级别。
# 使用过程必须遵循
 .csv文件在代码执行过程会持续写入数据，故不可直接打开，否则文件被占用会停止下载。如果不慎打开文件，关闭占用文件的程序后，重新执行拉流工具。
## 解决方案
 - 复制到其他文件夹打开。
# 退出码含义
 - 1 : 某条流实例初始化时get请求为空，检查错误日志中url，手工测试是否正确

# 配置文件 stream.conf 格式说明
保存路径   流名  源站URL  CDN加速url  
d:/ts/  test_stream_1  http://220.161.87.62:8800/hls/0/index.m3u8  http://220.161.87.62:8800/hls/0/index.m3u8  
d:/ts/  test_stream_2  http://220.161.87.62:8800/hls/0/index.m3u8  http://220.161.87.62:8800/hls/0/index.m3u8  
每条流一行
 - 保存路径：“d:/dir1/dir2/”绝对路径，/ 结尾，多条流可以保持一致，路径下按会流名创建文件夹
 - 流名：按流名分文件夹保存，不能有重复，不然文件备覆盖
 - 源站scheme：CDN配置的回源协议
 - 源站域名:端口号：CDN配置的回源域名和端口
 - CDN加速url：CDN加速的url，可获取到ts的
# 输出文件格式
 - 时延数据保存在“流名”文件夹下
 - m3u8、ts文件CDN流和源站流分别保存在cdn和src文件夹下
### 版本
 - 修复日志问题："process_ts_cdn" "if r_b is None" ，"Stream.get_delay" 打印的m3u8链接